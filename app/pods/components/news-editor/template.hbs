<div class='Container--noGutter'>
  <div class='row'>
    <div class='col-md-9'>
      <div class='NewsEditor-titleWrapper'>
        <h1 class='SectionHeader NewsEditor-title'>
          <span class='Section-text SectionHeader-text--secondaryBg'>{{title}}</span>
        </h1>
      </div>
    </div>
    <div class='col-md-3'>
      <div class='NewsEditor-autoSaveIndicator'>
        {{#if news.isDraft}}
          <div>
            {{#auto-save-indicator model=news as |saveStatus|}}
              {{saveStatus}}
            {{/auto-save-indicator}}
          </div>
        {{/if}}
      </div>
    </div>
  </div>
  <div class='row'>
    <div class='col-md-3 col-md-push-9'>
      <div class='Sidebar'>
        <div class='SidebarWidget'>
          <div class='PublishSettings'>
            <h2 class='SidebarWidget-header'><span class='SidebarWidget-text'>Publish Settings</span></h2>
            <div class='SidebarWidget-body' data-test-publish-status>
              <div class='PublishSettings-statusIndicator'>
                <p><b>Status: {{status}}</b></p>
              </div>

              {{#if news.isDraft}}
                {{#if isPickingScheduleDate}}
                  {{#form-group error=errors.publishedAt}}
                    <label class='control-label ContentForm-label--required' for="scheduled_date">
                      Publish Date
                    </label>
                    {{pick-a-date
                      date=(readonly selectedPubDate)
                      on-selected=(action (mut selectedPubDate))
                      placeholder="Pick a date"
                      class='form-control'
                      id="scheduled_date"
                    }}
                  {{/form-group}}
                  {{#form-group error=errors.publishedAt hideError=true}}
                    <label class='control-label ContentForm-label--required' for="scheduled_time">
                      Publish Time
                    </label>
                    {{pick-a-time
                      date=(readonly selectedPubDate)
                      on-selected=(action (mut selectedPubDate))
                      placeholder="Pick a time"
                      class='form-control'
                      id="scheduled_time"
                    }}
                  {{/form-group}}
                  <button {{action 'schedulePublish'}} class='btn btn-primary'>Confirm</button>
                  <button {{action 'cancelSchedulePublish'}} class='btn'>Cancel</button>
                {{else}}
                  <button {{action 'publish'}} class='btn btn-primary'>Publish Now</button><br />
                  <button {{action 'choosePubDate'}} class='btn'>Schedule Publish</button>
                {{/if}}
              {{/if}}

              {{#if news.isScheduled}}
                {{#if news.hasUnpublishedChanges}}
                  <p>This post is set to go live on {{formatted-date news.publishedAt}}</p>
                  <div class="alert alert-warning" role="alert"><p>Your post has changes that will not be included when your post goes live unless you save them.</p></div>
                  <button {{action 'publishChanges'}} class='btn btn-primary'>Save Changes</button><br />
                  <button {{action 'discardChanges'}} class='btn'>Discard changes</button>
                {{else}}
                  <p>This post is set to go live on {{formatted-date news.publishedAt}}
                    <a href='#' {{action 'unpublish'}} class='text-danger'><br />Cancel Scheduled Publish</a>
                  </p>
                  <button class='btn btn-primary' {{action 'publish'}}>Publish Now</button>
                {{/if}}
              {{/if}}

              {{#if news.isPublished}}
                Published {{formatted-date news.publishedAt}}.
                {{#if news.hasUnpublishedChanges}}
                  <div class="alert alert-warning" role="alert"><p>Your post has changes that are not published.</p></div>
                  <button {{action 'publish'}} class='btn btn-primary'>Publish Changes</button><br />
                  <button {{action 'discardChanges'}} class='btn'>Discard changes</button>
                {{/if}}
              {{/if}}
            </div>
          </div>
        </div>
        <div class='SidebarWidget'>
          {{#if news.isPublished}}
            <h2 class='SidebarWidget-header'><span class='SidebarWidget-text'>Organization</span></h2>
            <div class='SidebarWidget-body'>
              <p>This content is owned by <i>{{news.organization.name}}</i>.</p>
            </div>
          {{else}}
            {{#form-group error=errors.organization}}
              <h2 class='SidebarWidget-header'><span class='SidebarWidget-text'>Organization</span></h2>
              <div class='SidebarWidget-body'>
                <label class='h5 control-label ContentForm-label--required'>Content Owner</label>
                {{organization-dropdown
                defaultName='Please choose an org'
                selection=(readonly news.organization)
                organizations=filteredOrganizations
                class="with-border"
                updated=(action 'changeOrganization')
                }}
              </div>
            {{/form-group}}
         {{/if}}
        </div>

        {{#form-group}}
          <h2 class='SidebarWidget-header'><span class='SidebarWidget-text'>Featured Image</span></h2>
          <div class='SidebarWidget-body'>
          {{thumbnail-image-modal
          imageUrl=featuredImageUrl
          title="Featured Image"
          saveImage=(action 'saveFeaturedImage')
          }}
          </div>
        {{/form-group}}

        {{#if showDevFlags}}
        <div class='dev-flags'>
          <hr>
          <hr>
          isDirty: {{news.hasDirtyAttributes}}<br />
          canAutoSave: {{canAutosave}}<br />
          <hr>
          isDraft: {{news.isDraft}}<br />
          isScheduled: {{news.isScheduled}}<br />
          isPublished: {{news.isPublished}}<br />
          hasUnpublishedChanges: {{news.hasUnpublishedChanges}}<br />
          didOrgChange: {{didOrgChange}}
        </div>
        {{/if}}
      </div>
    </div>

    <div class='col-md-9 col-md-pull-3'>
      {{#form-group
        error=errors.title
        hideError=true
        news=news as |news|
      }}
        <label class='control-label ContentForm-label--required' for="title">Title</label>
        {{form-error errors.title}}

        {{input
          id='title'
          placeholder='A short and informative title'
          class='form-control'
          value=news.title
          data-test-field='title'
          input=(action 'notifyChange')
        }}
      {{/form-group}}

      <div class='NewsEditor-postBody u-dropShadow'>
        {{#form-group
          error=errors.subtitle
          hideError=true
          news=news as |news|
        }}
          <label class='control-label' for="title">Subtitle</label>
          {{form-error errors.subtitle}}

          {{input
            id='subtitle'
            placeholder='A short and informative subtitle'
            class='form-control'
            value=news.subtitle
            data-test-field='subtitle'
            input=(action 'notifyChange')
          }}
        {{/form-group}}

        {{#form-group
          error=errors.content
          hideError=true
          news=news as |news|
        }}
          <label class='control-label ContentForm-label--required' for="description">Content</label>
          {{form-error errors.content}}
          {{#summer-note
            content=news.content
            editorHeight=editorHeight
            toolbar=(mut editorConfig)
            validateForm=(action 'notifyChange')
            uploadImage=(action 'saveImage')
            class='ContentForm-textArea'
          }}
            {{textarea
              id='content'
              placeholder='Enter your content here...'
              class='form-control'
              data-test-textarea='content'
            }}
          {{/summer-note}}
        {{/form-group}}
      </div>
    </div>
  </div>
</div>
