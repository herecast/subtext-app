<div class='MainNav-wrapper'>
  <div class='Container--noGutter'>
    <div class='MainNav'>

      <div class='MainNav-brand'>
        <h1 class='MainNav-brand-logo'>
          {{#link-to 'index' (query-params page=1) data-test-link='header-link'}}
            daily UV
            {{#if (and session.isAuthenticated (or (eq currentChannel 'talk') (eq currentChannel 'index')))}}
              <span class='MainNav-brand-location'>
                {{session.userLocation}}
              </span>
            {{/if}}
          {{/link-to}}
        </h1>
      </div>

        <nav class='MainNav-channels' role="navigation">
          <ul class='SectionNavigation-list'>
            {{#if channelLinksEnabled}}
              <li class='SectionNavigation-listItem'>
              {{#link-to 'news'
              (query-params
              page=1
              query=newsFilter.defaultQuery
              organization=newsFilter.defaultOrganization
              location=newsFilter.defaultLocation
              locationId=newsFilter.defaultLocationId
              )
              class='SectionNavigation-link SectionNavigation-link--newsLink'
              current-when='news'
              data-test-link='news-channel'
              }}
                <span>News</span>
              {{/link-to}}
            </li>
            <li class='SectionNavigation-listItem'>
              {{#link-to 'events'
              (query-params
              page=1
              query=eventsFilter.defaultQuery
              category=eventsFilter.defaultCategory
              location=eventsFilter.defaultLocation
              date_start=eventsFilter.defaultStart
              date_end=eventsFilter.defaultEnd
              )
              class='SectionNavigation-link SectionNavigation-link--eventLink'
              current-when='events'
              data-test-link='events-channel'
              }}
                <span>Events</span>
              {{/link-to}}
            </li>
            <li class='SectionNavigation-listItem'>
              {{#link-to 'talk'
              (query-params
              page=1
              query=talkFilter.defaultQuery
              )
              class='SectionNavigation-link SectionNavigation-link--talkLink'
              current-when='talk'
              data-test-link='talk-channel'
              }}
                <span>Talk</span>
              {{/link-to}}
            </li>
            <li class='SectionNavigation-listItem'>
              {{#link-to 'market'
              (query-params
              page=1
              flat=false
              query=marketFilter.defaultQuery
              location=marketFilter.defaultLocation
              locationId=marketFilter.defaultLocationId
              )
              class='SectionNavigation-link SectionNavigation-link--marketLink'
              current-when='market'
              data-test-link='market-channel'
              }}
                <span>Market</span>
              {{/link-to}}
            </li>
            <li class='SectionNavigation-listItem'>
              {{#link-to 'directory'
              class='SectionNavigation-link SectionNavigation-link--directoryLink'
              current-when='directory'
              data-test-link='directory-channel'
              }}
                Directory
              {{/link-to}}
            </li>
              {{/if}}
          </ul>
        </nav>

      <div class='MainNav-search'>
        <!-- will contain user menu/login/register, search -->
        <ul class='list-inline'>
          <li>
            <span {{action 'openSearch'}} class='MainNav-search-searchButton'>
              {{fa-icon 'search'}}
            </span>
          </li>
          {{#unless session.isFastBoot}}
            {{#if session.isAuthenticated}}
              <li role="presentation" class="dropdown MainNav-userMenu {{if showUserMenu 'open'}}" data-test-component-user-menu>
                <a {{action 'toggleUserMenu'}}
                    href='#'
                    class='MainNav-moreLink'
                    data-test-link='user-menu'
                    role='button'
                    aria-haspopup="true"
                    aria-expanded="false">

                    {{avatar-image
                      imageUrl=session.currentUser.userImageUrl
                      userName=session.currentUser.name
                      hasCaret=true
                    }}
                </a>
                {{#if showUserMenu}}
                  {{#click-outside action=(action 'toggleUserMenu') class='dropdown-menu dropdown-menu-right open'}}
                    {{user-menu
                        openMyAccount=(action 'openAccountSettings')
                        model=session.currentUser
                        action=(action 'toggleUserMenu')
                      }}
                  {{/click-outside}}
                {{/if}}
              </li>
            {{else}}
              <li class='MainNav-signInJoin dropdown {{if showSignIn "open"}}'>
                <button {{action 'showSignInMenu' 'sign-in' bubbles=false}} class='btn-link' data-test-link='login-link'>
                  <span>Sign In</span>
                </button>
                <button {{action 'showSignInMenu' 'register' bubbles=false}} class='btn-link' data-test-link='join-link'>
                  <span>Join</span>
                </button>
                {{#if showSignIn}}
                  {{#click-outside action=(action 'closeSignInMenu') class='dropdown-menu dropdown-menu-right open'}}
                    {{sign-in-register-menu tab=signInTab action=(action 'closeSignInMenu')}}
                  {{/click-outside}}
                {{/if}}
              </li>
            {{/if}}
          {{/unless}}
          <li role="presentation" class="dropdown">
            <a {{action 'trackMenuOpen'}}
                href='#'
                class='MainNav-moreLink h2'
                role='button'
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false">
              {{fa-icon 'ellipsis-h'}}
            </a>
            {{extended-nav class="dropdown-menu dropdown-menu-right"}}
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>
