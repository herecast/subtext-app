{{business-feedback-badge result=model}}

<button class="DirectoryBusiness-feedback-button" {{action 'toggleDisplay'}}>
  {{if hasRated 'Rerate' 'Rate'}} Business
</button>

{{#if isOpen}}
  {{#modal-wrapper close=(action 'toggleDisplay') showHeader=false}}
    <div class="DirectoryFeedback-wrap">
      <div {{action 'toggleDisplay'}}>
        {{fa-icon 'times DirectoryFeedback-close'}}
      </div>

      {{#unless isSignedIn}}
        <h2 class="DirectoryFeedback-title">We'd love to get feedback from real users.</h2>
        <div class="DirectoryFeedback-questionsTitle">
          <h3>In order to keep ratings real, you must be signed in.</h3>
          <br>
          <h3>{{#link-to "login" target="_blank"}}Please click here to sign in.{{/link-to}}</h3>
        </div>
      {{else}}
        {{#if hasRated}}
          <div class="DirectoryFeedback-questionsTitle liftTop">
            <h3>You've already rated {{model.name}}</h3>
            <br>
            <div>You may only rate a business once. If youâ€™d like to change your rating, please click below:</div>
          </div>
        {{/if}}

        <div class="DirectoryFeedback-box">
          <h2 class="DirectoryFeedback-title">Would you recommend {{model.name}} to a friend?</h2>
          <div class="DirectoryFeedback-questionButton no {{buttonProperties.no}}" {{action 'checkAnswer' false}}>
            <span>No</span>
          </div>
          <div class="DirectoryFeedback-questionButton yes {{buttonProperties.yes}}" {{action 'checkAnswer' true}}>
            <span>Yes</span>
          </div>
        </div>
        <div>Your feedback is important to the community.</div>

        {{#if hasChosen}}
          <div class="DirectoryFeedback-questionsTitle">
            <br />
            <h3>You are signed in as <b>{{user.name}}</b></h3>
            <br />
            <h3>Just click below to submit your feedback.</h3>
          </div>
          <div class="DirectoryFeedback-submitFields">
            <button {{action 'submitFeedback'}} class="DirectoryFeedback-submitButton">Leave Verified Feedback</button>
          </div>
          <div class="DirectoryFeedback-questionsFooter">
            <div>Ratings are always anonymous.</div>
            <div>We promise not to share your rating information with anyone else.</div>
            <div>Your rating has been recorded and will be reflected shortly. Thank you.</div>
          </div>
        {{/if}}
      {{/unless}}
    </div>
  {{/modal-wrapper}}
{{/if}}
